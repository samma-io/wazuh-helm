apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-dashboard-conf
  namespace: {{ .Release.Namespace }}
  labels:
    app: {{ .Release.Name }}-dashboard
    component: dashboard
data:
  opensearch_dashboards.yml: |-
    server.host: 0.0.0.0
    server.port: 5601
    opensearch.hosts: https://{{ .Release.Name }}-indexer.{{ .Release.Namespace }}.svc.cluster.local:9200
    opensearch.ssl.verificationMode: certificate
    opensearch.requestHeadersWhitelist: ["securitytenant","Authorization"]
    opensearch_security.multitenancy.enabled: false
    opensearch_security.readonly_mode.roles: ["kibana_read_only"]
    server.ssl.enabled: true
    server.ssl.key: "/usr/share/wazuh-dashboard/certs/wazuh-dashboard-key.pem"
    server.ssl.certificate: "/usr/share/wazuh-dashboard/certs/wazuh-dashboard.pem"
    opensearch.ssl.certificateAuthorities: ["/usr/share/wazuh-dashboard/certs/root-ca.pem"]
    uiSettings.overrides.defaultRoute: /app/wz-home
    opensearch.username: {{ .Values.secrets.indexerUsername }}
    opensearch.password: {{ .Values.secrets.indexerPassword | quote }}
  wazuh.yml: |-
    hosts:
    - 1513629884013:
        url: "https://{{ .Release.Name }}-manager.{{ .Release.Namespace }}.svc.cluster.local"
        port: 55000
        username: {{ .Values.secrets.apiUsername }}
        password: {{ .Values.secrets.apiPassword | quote }}
        run_as: false